<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Way2Apps - All Applications</title>

<!-- html2canvas -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<!-- PDF.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.12.313/pdf.min.js"></script>
<script>
  pdfjsLib.GlobalWorkerOptions.workerSrc =
  'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.12.313/pdf.worker.min.js';
</script>

<!-- Tesseract OCR -->
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.0.2/dist/tesseract.min.js"></script>

<!-- Styles -->
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;}
body{background:#f4f4f8;color:#333;line-height:1.6;}
.navbar{display:flex;justify-content:space-between;align-items:center;padding:15px 20px;background:#1e90ff;color:#fff;position:sticky;top:0;z-index:100;}
.navbar .logo{font-size:1.5rem;font-weight:bold;}
.nav-links{display:flex;gap:15px;list-style:none;}
.nav-links li a{color:#fff;font-weight:500;transition:.3s;text-decoration:none;}
.nav-links li a:hover{color:#ffeb3b;}
.dark-mode-toggle{background:none;border:none;font-size:1.2rem;cursor:pointer;color:#fff;}
.hero{text-align:center;padding:60px 20px;background:linear-gradient(135deg,#1e90ff,#3742fa);color:#fff;}
.hero h1{font-size:2.5rem;margin-bottom:20px;}
.section{padding:50px 20px;max-width:1200px;margin:0 auto;}
.section h2{text-align:center;margin-bottom:30px;color:#1e90ff;font-size:2rem;}
.card-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px;}
.card{background:#fff;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.1);padding:20px;text-align:center;transition:transform .3s,box-shadow .3s;}
.card:hover{transform:translateY(-5px);box-shadow:0 12px 25px rgba(0,0,0,0.2);}
.card img{width:80px;margin-bottom:15px;}
.card h3{margin-bottom:10px;color:#3742fa;}
button.launch-btn{width:100%;padding:10px;background:#1e90ff;color:#fff;border:none;border-radius:8px;cursor:pointer;transition:.3s;}
button.launch-btn:hover{background:#3742fa;}
footer{text-align:center;padding:20px;background:#1e90ff;color:#fff;margin-top:50px;}
body.dark-mode{background:#121212;color:#ddd;}
body.dark-mode .navbar{background:#1b1b1b;}
body.dark-mode .nav-links li a{color:#ddd;}
body.dark-mode .nav-links li a:hover{color:#ffeb3b;}
body.dark-mode .hero{background:linear-gradient(135deg,#0d0d0d,#1b1b1b);}
body.dark-mode .card{background:#1f1f1f;box-shadow:0 8px 20px rgba(0,0,0,0.5);}
body.dark-mode .card h3{color:#1e90ff;}
body.dark-mode button.launch-btn{background:#3742fa;}
body.dark-mode button.launch-btn:hover{background:#1e90ff;}
@media (max-width:768px){.hero h1{font-size:2rem;}.nav-links{flex-direction:column;gap:10px;}}
.modal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgba(0,0,0,0.7);opacity:0;transition:opacity .3s;}
.modal.show{display:block;opacity:1;}
.modal-content{background-color:#fff;margin:5% auto;padding:20px;border-radius:12px;width:90%;max-width:500px;position:relative;transform:translateY(-20px);transition:transform .3s;}
.modal.show .modal-content{transform:translateY(0);}
body.dark-mode .modal-content{background:#1f1f1f;color:#ddd;}
.modal .close{color:#aaa;position:absolute;top:10px;right:20px;font-size:28px;cursor:pointer;}
.modal .close:hover{color:#000;}
input, select{padding:8px;margin:5px 0;width:100%;border-radius:6px;border:1px solid #ccc;}
.result{margin-top:10px;font-weight:bold;white-space:pre-wrap;}
.buttons{display:flex;gap:10px;margin-top:10px;flex-wrap:wrap;}
</style>
<style>
.modal .close:hover{color:#000;}
input, select{padding:8px;margin:5px 0;width:100%;border-radius:6px;border:1px solid #ccc;}
.result{margin-top:10px;font-weight:bold;white-space:pre-wrap;}
.buttons{display:flex;gap:10px;margin-top:10px;flex-wrap:wrap;}
</style>
</head>
<body>

<nav class="navbar">
<div class="logo">Way2Apps</div>
<ul class="nav-links">
<li><a href="#top-apps">Top Apps</a></li>
<li><a href="#family">Family</a></li>
<li><a href="#student">Student</a></li>
<li><a href="#fun">Fun</a></li>
<li><a href="#languages">Languages</a></li>
<li><a href="#info">Info</a></li>
</ul>
<button class="dark-mode-toggle">ðŸŒ™</button>
</nav>

<header class="hero">
<h1>All your smart, useful, and fun web applications â€” in one place.</h1>
</header>

<!-- Top Apps -->
<section id="top-apps" class="section">
<h2>Top Apps</h2>
<div class="card-grid">
<div class="card"><img src="assets/images/age.png"><h3>Age Calculator</h3><button class="launch-btn" onclick="openModal('ageModal')">Launch</button></div>
<div class="card"><img src="assets/images/image-text.png"><h3>Image to Text</h3><button class="launch-btn" onclick="openModal('imageTextModal')">Launch</button></div>
<!-- Text Tools Hub Card -->
<div class="card">
  <img src="assets/images/text-tools.png">
  <h3>Text Tools Hub</h3>
  <button class="launch-btn" onclick="openModal('textToolsModal')">Launch</button>
</div>

<div class="card"><img src="assets/images/calories.png"><h3>Calories Calculator</h3><button class="launch-btn" onclick="openModal('caloriesModal')">Launch</button></div>
<div class="card"><img src="assets/images/bmi.png"><h3>BMI Checker</h3><button class="launch-btn" onclick="openModal('bmiModal')">Launch</button></div>
<div class="card"><img src="assets/images/child-growth.png"><h3>Child Growth</h3><button class="launch-btn" onclick="openModal('childGrowthModal')">Launch</button></div>
</div>
</section>

<!-- Family -->
<section id="family" class="section">
<h2>Family Apps</h2>
<div class="card-grid">
<div class="card"><img src="assets/images/baby.png"><h3>Baby Milestone</h3><button class="launch-btn" onclick="openModal('babyModal')">Launch</button></div>
<div class="card"><img src="assets/images/cry.png"><h3>Baby Cry Analyzer</h3><button class="launch-btn" onclick="openModal('cryModal')">Launch</button></div>
<div class="card"><img src="assets/images/health.png"><h3>Health Tracker</h3><button class="launch-btn" onclick="openModal('healthModal')">Launch</button></div>
</div>
</section>

<!-- Student -->
<section id="student" class="section">
<h2>Student Apps</h2>
<div class="card-grid">
<div class="card"><img src="assets/images/data.png"><h3>Data Visualizer</h3><button class="launch-btn" onclick="openModal('dataModal')">Launch</button></div>
<div class="card"><img src="assets/images/3d.png"><h3>3D PDF Generator</h3><button class="launch-btn" onclick="openModal('pdf3DModal')">Launch</button></div>
<div class="card"><img src="assets/images/quiz.png"><h3>Quiz Game</h3><button class="launch-btn" onclick="openModal('quizModal')">Launch</button></div>
</div>
</section>

<!-- Fun -->
<section id="fun" class="section">
<h2>Fun Apps</h2>
<div class="card-grid">
<div class="card"><img src="assets/images/game.png"><h3>Fun Game</h3><button class="launch-btn" onclick="openModal('funGameModal')">Launch</button></div>
</div>
</section>

<!-- Languages -->
<section id="languages" class="section">
<h2>Language Learning</h2>
<div class="card-grid">
<div class="card"><img src="assets/images/personality.png"><h3>Personality</h3><button class="launch-btn" onclick="openModal('personalityModal')">Launch</button></div>
<div class="card"><img src="assets/images/fun-profile.png"><h3>Fun Profile</h3><button class="launch-btn" onclick="openModal('funProfileModal')">Launch</button></div>
<div class="card"><img src="assets/images/planets.png"><h3>Planets Explorer</h3><button class="launch-btn" onclick="openModal('planetsModal')">Launch</button></div>
</div>
</section>

<!-- Info -->
<section id="info" class="section">
<h2>News & Info</h2>
<div class="card-grid">
<div class="card"><img src="assets/images/news.png"><h3>News & Info</h3><button class="launch-btn" onclick="openModal('newsModal')">Launch</button></div>
</div>
</section>

<!-- Modals (Top Apps) -->
<div id="ageModal" class="modal">
<div class="modal-content"><span class="close" onclick="closeModal('ageModal')">&times;</span>
<h3>Age Calculator</h3>
<label>Birth Date:</label><input type="date" id="birthDate">
<label>Current Date:</label><input type="date" id="currentDate" value="">
<button onclick="calculateAge()">Calculate</button>
<p class="result" id="ageResult"></p>
</div>
</div>


<div id="imageTextModal" class="modal">
<div class="modal-content"><span class="close" onclick="closeModal('imageTextModal')">&times;</span>
<h3>Image to Text</h3>
<input type="file" id="imageFile" accept="image/*">
<button onclick="extractImageText()">Extract Text</button>
<p class="result" id="imageResult"></p>
<button id="downloadImageText" style="display:none;" onclick="downloadText('imageResult','image_text.txt')">Download as .txt</button>
</div>
</div>

<!-- Text Tools Hub Modal -->
<div id="textToolsModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal('textToolsModal')">&times;</span>
    <h3>Text Tools Hub</h3>

    <textarea id="textInput" rows="6" placeholder="Paste your text here..." oninput="updateCounter()"></textarea>
    <p id="textCounter">Words: 0 | Characters: 0</p>

    <div class="buttons">
      <button onclick="toUpper()">UPPERCASE</button>
      <button onclick="toLower()">lowercase</button>
      <button onclick="capitalizeText()">Capitalize</button>
      <button onclick="removeExtraSpaces()">Clean Text</button>
      <button onclick="removeDuplicateLines()">Remove Duplicates</button>
      <button onclick="textToSlug()">Text â†’ Slug</button>
      <button onclick="clearText()">Clear</button>
    </div>

    <p class="result" id="textResult"></p>

    <div class="buttons">
      <button onclick="copyResult('textResult')">Copy</button>
      <button onclick="downloadText('textResult','text-tools.txt')">Download</button>
    </div>
  </div>
</div>


<!-- Calories Calculator Modal -->
<div id="caloriesModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal('caloriesModal')">&times;</span>
    <h3>Calories Calculator</h3>

    <label>Weight (kg):</label>
    <input type="number" id="weight" placeholder="Ex: 70" min="1" max="300">

    <label>Height (cm):</label>
    <input type="number" id="height" placeholder="Ex: 175" min="50" max="250">

    <label>Age:</label>
    <input type="number" id="ageCal" placeholder="Ex: 25" min="1" max="120">

    <button onclick="calculateCalories()" class="launch-btn">Calculate</button>

    <p class="result" id="caloriesResult"></p>
  </div>
</div>


<!-- BMI Checker Modal -->
<div id="bmiModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal('bmiModal')">&times;</span>
    <h3>BMI Checker</h3>
    <label>Weight (kg):</label>
    <input type="number" id="bmiWeight" placeholder="Enter your weight">
    <label>Height (cm):</label>
    <input type="number" id="bmiHeight" placeholder="Enter your height">
    <button onclick="calculateBMI()">Check BMI</button>
    <p class="result" id="bmiResult"></p>
  </div>
</div>

<div id="childGrowthModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal('childGrowthModal')">&times;</span>
    <h3>Child Growth Tracker</h3>

    <label>Gender:</label>
    <select id="childGender">
      <option value="male">Male</option>
      <option value="female">Female</option>
    </select>

    <label>Birth Date:</label>
    <input type="date" id="childBirth">

    <label>Measurement Date:</label>
    <input type="date" id="childMeasure" value="">

    <label>Weight (kg):</label>
    <input type="number" id="childWeight">

    <label>Height (cm):</label>
    <input type="number" id="childHeight">

    <button onclick="addMeasurement()">Add Measurement</button>
    <button onclick="resetMeasurements()">Reset</button>

    <div id="childGrowthReport" style="margin-top:15px;">
      <p class="result" id="childGrowthResult"></p>
      <p id="childGrowthStatus"></p>
      <p id="childGrowthAdvice"></p>
      <canvas id="growthChart" width="400" height="250"></canvas>
    </div>

    <button onclick="exportGrowthPDF()">Download PDF</button>
  </div>
</div>

<!-- Baby Milestone Modal -->
<div id="babyModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal('babyModal')">&times;</span>
    <h3>Baby Milestone Tracker</h3>

    <label>Baby Name:</label>
    <input type="text" id="babyName" placeholder="Enter baby name">

    <label>Birth Date:</label>
    <input type="date" id="babyBirth">

    <label>Milestone Date:</label>
    <input type="date" id="milestoneDate">

    <label>Milestone Description:</label>
    <textarea id="milestoneDesc" rows="4" placeholder="Describe the milestone..."></textarea>

    <button onclick="addBabyMilestone()">Add Milestone</button>
    <button onclick="resetBabyMilestones()">Reset</button>

    <div id="babyMilestoneReport" style="margin-top:15px;">
      <p class="result" id="babyMilestoneList"></p>
    </div>

    <button onclick="exportBabyMilestonesPDF()">Download PDF</button>
  </div>
</div>


<footer>Â© 2025 Way2Apps | All Rights Reserved</footer>

<script>
document.querySelector('.dark-mode-toggle').addEventListener('click',()=>document.body.classList.toggle('dark-mode'));
document.getElementById('currentDate').value=new Date().toISOString().split('T')[0];

function openModal(id){document.getElementById(id).classList.add('show');}
function closeModal(id){document.getElementById(id).classList.remove('show');}
window.onclick=function(event){document.querySelectorAll('.modal').forEach(modal=>{if(event.target==modal)modal.classList.remove('show');});}

// Age Calculator
function calculateAge(){
  const b=document.getElementById('birthDate').value;
  const c=document.getElementById('currentDate').value;
  if(!b||!c){alert('Enter dates');return;}
  const bd=new Date(b),cd=new Date(c);
  let y=cd.getFullYear()-bd.getFullYear(),m=cd.getMonth()-bd.getMonth(),d=cd.getDate()-bd.getDate();
  if(d<0){m--;d+=new Date(cd.getFullYear(),cd.getMonth(),0).getDate();}
  if(m<0){y--;m+=12;}
  document.getElementById('ageResult').innerText=`${y} ans ${m} mois ${d} jours`;
}

// Copy text
function copyResult(id){
  const text = document.getElementById(id).innerText;
  navigator.clipboard.writeText(text).then(()=>alert("Copied!"));
}

// Download text as file
function downloadText(elementId, filename){
  const text = document.getElementById(elementId).innerText;
  const blob = new Blob([text], { type: 'text/plain' });
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = filename;
  link.click();
}


// Copy result
function copyResult(id){
  const text = document.getElementById(id).innerText;
  navigator.clipboard.writeText(text).then(()=>alert("Copied!"));
}

// Download result
function downloadText(elementId, filename){
  const text = document.getElementById(elementId).innerText;
  const blob = new Blob([text], { type: 'text/plain' });
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = filename;
  link.click();
}

// Modal open/close
function openModal(id){document.getElementById(id).classList.add('show');}
function closeModal(id){document.getElementById(id).classList.remove('show');}
window.onclick=function(event){document.querySelectorAll('.modal').forEach(modal=>{if(event.target==modal)modal.classList.remove('show');});}



// Copy & Download
function copyResult(id){
  const text = document.getElementById(id).innerText;
  navigator.clipboard.writeText(text).then(()=>alert("Copied!"));
}

function downloadText(elementId, filename){
  const text = document.getElementById(elementId).innerText;
  const blob = new Blob([text], { type: 'text/plain' });
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = filename;
  link.click();
}

// Modal functions
function openModal(id){document.getElementById(id).classList.add('show');}
function closeModal(id){document.getElementById(id).classList.remove('show');}
window.onclick = function(event){
  document.querySelectorAll('.modal').forEach(modal=>{
    if(event.target==modal) modal.classList.remove('show');
  });
};

// Image to Text
function extractImageText(){
  const file=document.getElementById('imageFile').files[0];
  if(!file){alert('Select an image');return;}
  document.getElementById('imageResult').innerText="Processing...";
  Tesseract.recognize(file,'eng',{logger:m=>console.log(m)}).then(({data:{text}})=>{
    document.getElementById('imageResult').innerText=text;
    document.getElementById('downloadImageText').style.display='inline-block';
  });
}

// Word & Character Counter
function updateCounter(){
  const t = document.getElementById('textInput').value;
  const words = t.trim().split(/\s+/).filter(Boolean).length;
  const chars = t.length;
  document.getElementById('textCounter').innerText = `Words: ${words} | Characters: ${chars}`;
}

// Clear Text
function clearText(){
  document.getElementById('textInput').value = '';
  document.getElementById('textResult').innerText = '';
  document.getElementById('textCounter').innerText = 'Words: 0 | Characters: 0';
}

// Convert text to UPPERCASE
function toUpper(){
  const t = document.getElementById('textInput').value;
  document.getElementById('textResult').innerText = t.toUpperCase();
}

// Convert text to lowercase
function toLower(){
  const t = document.getElementById('textInput').value;
  document.getElementById('textResult').innerText = t.toLowerCase();
}

// Capitalize each word
function capitalizeText(){
  const t = document.getElementById('textInput').value;
  document.getElementById('textResult').innerText =
    t.toLowerCase().replace(/\b\w/g, c => c.toUpperCase());
}

// Clean Text (remove extra spaces but keep lines)
function removeExtraSpaces(){
  const t = document.getElementById('textInput').value;
  const lines = t.split('\n').map(line => line.replace(/\s+/g,' ').trim());
  document.getElementById('textResult').innerText = lines.join('\n');
}

// Remove duplicate lines (ignore case, trim spaces)
function removeDuplicateLines(){
  const t = document.getElementById('textInput').value;
  const lines = t.split('\n').map(line => line.trim());
  const uniqueLines = [...new Set(lines.map(line => line.toLowerCase()))];
  document.getElementById('textResult').innerText = uniqueLines.join('\n');
}

// Convert text to Slug (safe, no errors)
function textToSlug(){
  const t = document.getElementById('textInput').value;

  // Normalize text to remove accents
  const normalized = t.normalize("NFD").replace(/[\u0300-\u036f]/g, "");

  // Keep only letters, numbers, dash, and spaces
  const cleaned = normalized.replace(/[^a-zA-Z0-9\s-]/g, '');

  // Replace multiple spaces with a single dash and convert to lowercase
  const slug = cleaned.trim().replace(/\s+/g, '-').toLowerCase();

  document.getElementById('textResult').innerText = slug;
}

// Copy result to clipboard
function copyResult(id){
  const text = document.getElementById(id).innerText;
  navigator.clipboard.writeText(text).then(()=>alert("Copied!"));
}

// Download result as .txt file
function downloadText(elementId, filename){
  const text = document.getElementById(elementId).innerText;
  const blob = new Blob([text], { type: 'text/plain' });
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = filename;
  link.click();
}

// Download Text
function downloadText(elementId, filename){
  const text=document.getElementById(elementId).innerText;
  const blob=new Blob([text],{type:'text/plain'});
  const link=document.createElement('a');
  link.href=URL.createObjectURL(blob);
  link.download=filename;
  link.click();
}

// Copy
function copyResult(id){navigator.clipboard.writeText(document.getElementById(id).innerText).then(()=>alert("Copied!"));}

// Export Text
function exportText(id){const text=document.getElementById(id).innerText; const blob=new Blob([text],{type:"text/plain;charset=utf-8"}); const link=document.createElement("a"); link.href=URL.createObjectURL(blob); link.download="result.txt"; link.click();}

// Calories Calculator
function calculateCalories(){
  const w=parseFloat(document.getElementById('weight').value);
  const h=parseFloat(document.getElementById('height').value);
  const a=parseFloat(document.getElementById('ageCal').value);

  if(isNaN(w)||isNaN(h)||isNaN(a)||w<=0||h<=0||a<=0){
    alert('Enter valid values'); 
    return;
  }

  const calories = 10*w + 6.25*h - 5*a + 5; // BMR for men
  document.getElementById('caloriesResult').innerText = `Calories: ${calories.toFixed(0)} kcal/day`;
}

// ÙØªØ­ ÙˆØ¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„
function openModal(id){
  document.getElementById(id).classList.add('show');
}
function closeModal(id){
  document.getElementById(id).classList.remove('show');
}
window.onclick = function(event){
  document.querySelectorAll('.modal').forEach(modal => {
    if(event.target == modal) modal.classList.remove('show');
  });
}

// Ø­Ø³Ø§Ø¨ BMI
function calculateBMI(){
  const weight = parseFloat(document.getElementById('bmiWeight').value);
  const height = parseFloat(document.getElementById('bmiHeight').value) / 100; // ØªØ­ÙˆÙŠÙ„ cm Ø¥Ù„Ù‰ m

  if(isNaN(weight) || isNaN(height) || height === 0){
    alert('Enter valid values!');
    return;
  }

  const bmi = weight / (height * height);
  let category = '';

  if(bmi < 18.5) category = 'Underweight';
  else if(bmi < 24.9) category = 'Normal weight';
  else if(bmi < 29.9) category = 'Overweight';
  else category = 'Obesity';

  document.getElementById('bmiResult').innerText = `BMI: ${bmi.toFixed(1)} (${category})`;
}


// Child Growth
let growthData = [];
let growthChart = null;

// WHO Growth Standards (simplified example)
const whoGrowth = {
  male: {0:{weight:3.3,height:49.9},1:{weight:4.5,height:54.7},2:{weight:5.6,height:58.4},3:{weight:6.4,height:61.4},6:{weight:7.9,height:67.6},12:{weight:9.6,height:76.1},24:{weight:12.2,height:87.8},36:{weight:14.3,height:96.1}},
  female: {0:{weight:3.2,height:49.1},1:{weight:4.2,height:53.7},2:{weight:5.1,height:57.1},3:{weight:5.8,height:59.8},6:{weight:7.3,height:65.7},12:{weight:9.1,height:74.0},24:{weight:11.5,height:85.7},36:{weight:13.9,height:95.0}}
};

function addMeasurement() {
  const gender = document.getElementById('childGender').value;
  const b = document.getElementById('childBirth').value;
  const m = document.getElementById('childMeasure').value;
  const w = parseFloat(document.getElementById('childWeight').value);
  const h = parseFloat(document.getElementById('childHeight').value);

  if(!b || !m || isNaN(w) || isNaN(h)) { alert('Enter all valid values'); return; }

  const bd = new Date(b), md = new Date(m);
  if(md < bd){ alert('Measurement date must be after birth'); return; }

  let y = md.getFullYear() - bd.getFullYear();
  let mo = md.getMonth() - bd.getMonth();
  let d = md.getDate() - bd.getDate();
  if(d < 0){ mo--; d += new Date(md.getFullYear(), md.getMonth(),0).getDate(); }
  if(mo < 0){ y--; mo += 12; }
  const ageMonths = y*12 + mo;

  const heightM = h/100;
  const bmi = w / (heightM*heightM);

  // WHO comparison
  const who = whoGrowth[gender];
  let nearestAge = Object.keys(who).reduce((prev,curr)=>Math.abs(curr-ageMonths)<Math.abs(prev-ageMonths)?curr:prev);
  const whoWeight = who[nearestAge].weight;
  const whoHeight = who[nearestAge].height;

  let status='', advice='';
  if(w < whoWeight*0.9 || h < whoHeight*0.95) {
    status = 'Below Average';
    advice = 'Underweight: Encourage healthy growth, consult pediatrician.';
  } else if(w <= whoWeight*1.1 && h <= whoHeight*1.05) {
    status = 'Normal';
    advice = 'Growth is on track.';
  } else {
    status = 'Above Average';
    advice = 'Overweight/Risk of Obesity: Monitor diet and activity.';
  }

  growthData.push({ageMonths, weight:w, height:h, bmi, status, advice});

  const latest = growthData[growthData.length-1];
  document.getElementById('childGrowthResult').innerText = 
    `Age: ${latest.ageMonths} months\nWeight: ${latest.weight} kg\nHeight: ${latest.height} cm\nBMI: ${latest.bmi.toFixed(1)}\nWHO Avg Weight: ${whoWeight} kg, Height: ${whoHeight} cm`;
  
  const statusEl = document.getElementById('childGrowthStatus');
  statusEl.innerText = `Growth Status: ${latest.status}`;
  statusEl.style.color = (latest.status==='Normal')?'green':(latest.status==='Below Average')?'orange':'red';

  document.getElementById('childGrowthAdvice').innerText = `Advice: ${latest.advice}`;

  renderGrowthChart(gender);
}

function renderGrowthChart(gender) {
  const ctx = document.getElementById('growthChart').getContext('2d');
  const labels = growthData.map(d=>`${d.ageMonths} mo`);
  const weightData = growthData.map(d=>d.weight);
  const heightData = growthData.map(d=>d.height);

  const who = whoGrowth[gender];
  const whoLabels = Object.keys(who);
  const whoWeightLine = whoLabels.map(m=>who[m].weight);
  const whoHeightLine = whoLabels.map(m=>who[m].height);

  if(growthChart) growthChart.destroy();

  growthChart = new Chart(ctx,{
    type:'line',
    data:{
      labels: labels,
      datasets:[
        {label:'Weight (kg)', data: weightData, borderColor: 'blue', backgroundColor:'transparent', tension:0.3, pointRadius:6},
        {label:'Height (cm)', data: heightData, borderColor:'green', backgroundColor:'transparent', tension:0.3, pointRadius:6},
        {label:'WHO Avg Weight', data: whoWeightLine, borderColor:'blue', borderDash:[5,5], fill:false, tension:0.1, pointRadius:0},
        {label:'WHO Avg Height', data: whoHeightLine, borderColor:'green', borderDash:[5,5], fill:false, tension:0.1, pointRadius:0}
      ]
    },
    options:{responsive:true, scales:{y:{beginAtZero:true}}}
  });
}

function resetMeasurements() {
  if(confirm('Reset all measurements?')) {
    growthData = [];
    if(growthChart) growthChart.destroy();
    document.getElementById('childGrowthResult').innerText = '';
    document.getElementById('childGrowthStatus').innerText = '';
    document.getElementById('childGrowthAdvice').innerText = '';
  }
}

function exportGrowthPDF() {
  const report = document.getElementById('childGrowthReport');
  if (!report) { alert('No report to export'); return; }

  html2canvas(report).then(canvas => {
    const imgData = canvas.toDataURL('image/png');
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({
      orientation: 'portrait',
      unit: 'px',
      format: [canvas.width, canvas.height]
    });
    pdf.addImage(imgData, 'PNG', 0, 0, canvas.width, canvas.height);
    pdf.save('ChildGrowthReport.pdf');
  });
}



// ==========================
// Baby Milestone Data
// ==========================
let babyMilestones = [];

// ==========================
// Add Milestone
// ==========================
function addBabyMilestone() {
  const name = document.getElementById('babyName').value.trim();
  const birth = document.getElementById('babyBirth').value;
  const date = document.getElementById('milestoneDate').value;
  const desc = document.getElementById('milestoneDesc').value.trim();

  if (!name || !birth || !date || !desc) {
    alert('Please fill all fields');
    return;
  }

  const milestone = { name, birth, date, desc };
  babyMilestones.push(milestone);

  renderBabyMilestones();
}

// ==========================
// Reset Milestones
// ==========================
function resetBabyMilestones() {
  if (confirm('Reset all milestones?')) {
    babyMilestones = [];
    renderBabyMilestones();
  }
}

// ==========================
// Render Milestone List
// ==========================
function renderBabyMilestones() {
  const listEl = document.getElementById('babyMilestoneList');
  if (babyMilestones.length === 0) {
    listEl.innerHTML = 'No milestones added yet.';
    return;
  }
  listEl.innerHTML = babyMilestones.map((m, i) => 
    `<strong>${i+1}. ${m.name}</strong> | Birth: ${m.birth} | Date: ${m.date}<br>Milestone: ${m.desc}<br><hr>`
  ).join('');
}

// ==========================
// Export PDF
// ==========================
function exportBabyMilestonesPDF() {
  const report = document.getElementById('babyMilestoneReport');
  if (!report) { alert('No report to export'); return; }

  // Make sure modal is visible before capturing
  report.parentElement.style.display = 'block';

  html2canvas(report).then(canvas => {
    const imgData = canvas.toDataURL('image/png');
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({
      orientation: 'portrait',
      unit: 'px',
      format: [canvas.width, canvas.height]
    });
    pdf.addImage(imgData, 'PNG', 0, 0, canvas.width, canvas.height);
    pdf.save('BabyMilestones.pdf');
  });
}

// ==========================
// Modal Functions
// ==========================
function openModal(id) {
  document.getElementById(id).classList.add('show');
}

function closeModal(id) {
  document.getElementById(id).classList.remove('show');
}

window.onclick = function(event) {
  document.querySelectorAll('.modal').forEach(modal => {
    if (event.target == modal) modal.classList.remove('show');
  });
}

</script>



</body>
</html>
